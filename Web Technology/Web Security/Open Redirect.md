**Open Redirect** или **"Непроверенные переадресации и пересылки"** - уязвимость, которая позволяет веб-сайту передавать посетителю другой URL-адрес, возможно в другом домене. Сама по себе не является вредоносной, но в сочетании с другими действиями может быть опасной.

К примеру, есть доверенный сайт http://site.com, на который могут зайти только авторизованные пользователи. У этого сайта есть отдельный сервис для авторизации, скажем, http://site.auth.com. Мы заходим на сайт http://site.com и нас перебрасывает на сайт авторизации (так как мы зашли в первый раз), в адресной строке видим параметр **redirectURI** (это параметр может называться как угодно), где указан сайт, с которого нас перебросила. Это сделано для удобства, чтобы при успешной авторизации на http://site.auth.com нас перебросила обратно на http://site.com. Если в параметр **redirectURI** будет иной URL, который ведет на другой сайт или даже другой домен, и после логирования нас перебросит, то это уязвимость Open Redirect. Этот URL может ввести на фишинговый сайт, где пользователь может ввести повторный пароль (подумает, что в первый раз ввел неверный пароль и/или логин) и его данные украдут.

Куки не могут передавать между доменами, это сделаны в целях безопасности. А вот в пределах одного домена могут.  Также в качестве домена в куки нельзя задавать домены первого уровня.

Уязвимость возникает, когда разработчик позволяет через ввод перенаправить браузер к другому сайту. Для этого применяет параметры URL-адреса, HTML-теги <meta> для обновления страницы или свойство DOM window.location.

Чтобы защититься от Open Redirect можно:
1.  Создать межсайтовую страницу, где будет появляться при переходе информация о том, что он покидает текущий домен;
2. Можно проверять URL, на который планируется переход (сузить домен или сделать вайтлист доступных доменов).

---
Теги: #web-security 